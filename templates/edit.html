{{ template "header.html" . }}

<div class="max-w-2xl mx-auto bg-white dark:bg-zinc-800 p-8 rounded-lg shadow-md">
    <h1 class="text-2xl font-bold mb-6">Edit Resep</h1>

    <form action="/edit/{{ .Recipe.ID }}" method="POST" enctype="multipart/form-data" class="space-y-6">
        
        <div>
            <label class="block text-sm font-medium mb-1">Title Recipe</label>
            <input type="text" name="title" value="{{ .Recipe.Title }}" required class="w-full rounded-md border-gray-300 bg-gray-50 dark:bg-zinc-700 dark:border-zinc-600 p-2 focus:ring-2 focus:ring-indigo-500 outline-none">
        </div>

        <div>
            <label class="block text-sm font-medium mb-1">Description</label>
            <textarea name="description" rows="3" required class="w-full rounded-md border-gray-300 bg-gray-50 dark:bg-zinc-700 dark:border-zinc-600 p-2 focus:ring-2 focus:ring-indigo-500 outline-none">{{ .Recipe.Description }}</textarea>
        </div>

        <div>
            <label class="block text-sm font-medium mb-1">Ingredients</label>
            <textarea name="ingredients" rows="4" required class="w-full rounded-md border-gray-300 bg-gray-50 dark:bg-zinc-700 dark:border-zinc-600 p-2 focus:ring-2 focus:ring-indigo-500 outline-none">{{ .Recipe.Ingredients }}</textarea>
        </div>

        <div>
            <label class="block text-sm font-medium mb-1">Instructions</label>
            <textarea name="instructions" rows="4" required class="w-full rounded-md border-gray-300 bg-gray-50 dark:bg-zinc-700 dark:border-zinc-600 p-2 focus:ring-2 focus:ring-indigo-500 outline-none">{{ .Recipe.Instructions }}</textarea>
        </div>

   
        <div>
            <label class="block text-sm font-medium mb-2">Image</label>
            

            {{ if .Recipe.Image }}
            <div id="current-image" class="mb-3 relative group">
                <img src="/{{ .Recipe.Image }}" class="w-full h-64 object-cover rounded-lg">
                <div class="absolute inset-0 bg-black bg-opacity-50 flex items-center justify-center opacity-0 group-hover:opacity-100 transition rounded-lg">
                    <p class="text-white text-sm">Current image</p>
                </div>
            </div>
            {{ end }}

            <div id="preview-container" class="hidden mb-3 relative group">
                <img id="preview-image" src="" class="w-full h-64 object-cover rounded-lg">
                <button type="button" onclick="removeImage()" class="absolute top-2 right-2 bg-red-500 text-white p-2 rounded-full shadow hover:bg-red-600">
                    <i class="fas fa-trash"></i>
                </button>
            </div>

            <label id="drop-zone" class="flex justify-center w-full h-32 px-4 transition bg-white dark:bg-zinc-800 border-2 border-gray-300 dark:border-zinc-600 border-dashed rounded-md appearance-none cursor-pointer hover:border-indigo-500 focus:outline-none">
                <span class="flex items-center space-x-2">
                    <i class="fas fa-cloud-upload-alt text-2xl text-gray-400"></i>
                    <span class="font-medium text-gray-600 dark:text-gray-300">
                        Change image
                    </span>
                </span>
                <input type="file" name="image" class="hidden" accept="image/*" onchange="previewFile(this)">
            </label>
        </div>

        <div class="pt-4 flex gap-4">
            <button type="submit" class="bg-indigo-600 text-white px-6 py-2.5 rounded-lg font-semibold hover:bg-indigo-700 transition">
                Update Resep
            </button>
            <a href="/recipe/{{ .Recipe.ID }}" class="text-gray-500 hover:text-gray-700 py-2.5">Batal</a>
        </div>
    </form>
</div>

<script>
    function previewFile(input) {
        var file = input.files[0];
        if(file){
            var reader = new FileReader();
            reader.onload = function(){
                document.getElementById('preview-image').src = reader.result;
                document.getElementById('preview-container').classList.remove('hidden');
                document.getElementById('drop-zone').classList.add('hidden');
                var currentImage = document.getElementById('current-image');
                if(currentImage) currentImage.classList.add('hidden');
            }
            reader.readAsDataURL(file);
        }
    }

    function removeImage() {
        document.querySelector('input[name="image"]').value = '';
        document.getElementById('preview-container').classList.add('hidden');
        document.getElementById('drop-zone').classList.remove('hidden');
        var currentImage = document.getElementById('current-image');
        if(currentImage) currentImage.classList.remove('hidden');
    }
</script>

{{ template "footer.html" . }}
